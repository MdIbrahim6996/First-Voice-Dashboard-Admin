import{j as e,m as r,r as t,A as S,d as D,u}from"./index-CM52sLvF.js";import{g as L}from"./status-CDMecnCR.js";import{g as $}from"./lead-DfGRg-Sk.js";import{E as k}from"./EmptyState-CxFCon6Z.js";import{L as F}from"./Loader-rr3d_VAy.js";const z=({item:l,handleClose:o})=>e.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black/60 z-50",children:e.jsxs(r.div,{initial:{opacity:.5,y:-50},animate:{opacity:1,y:0},transition:{duration:.5},className:"bg-white rounded-lg shadow-lg w-full max-w-xl  overflow-hidden",children:[e.jsx("div",{className:"",children:e.jsx("p",{className:"bg-gray-200 py-2 px-6 text-xl",children:"Change In Status Information."})}),e.jsxs("div",{className:"px-4 py-2",children:[e.jsx("div",{children:l?.map(a=>e.jsxs("div",{className:"my-3 border border-slate-400 rounded-md p-2",children:[e.jsxs("p",{children:[e.jsx("span",{className:`${a?.fromStatus.toLowerCase()==="success"?"bg-green-500":""} ${a?.fromStatus.toLowerCase()==="cancelled"?"bg-red-500":""} ${a?.fromStatus.toLowerCase()==="pending"?"bg-yellow-500":""} ${a?.fromStatus.toLowerCase()==="rework/warmup"?"bg-sky-500":""} bg-gray-500 text-white text-xs font-semibold px-6 py-1 mr-2 rounded-md capitalize cursor-pointer`,children:a?.fromStatus}),"â†’",e.jsx("span",{className:`${a?.toStatus.toLowerCase()==="success"?"bg-green-500":""} ${a?.toStatus.toLowerCase()==="cancelled"?"bg-red-500":""} ${a?.toStatus.toLowerCase()==="pending"?"bg-yellow-500":""} ${a?.toStatus.toLowerCase()==="rework/warmup"?"bg-sky-500":""} bg-gray-500 text-white text-xs font-semibold px-6 py-1 ml-2 rounded-md capitalize cursor-pointer`,children:a?.toStatus})]}),e.jsxs("div",{className:"mt-2 flex items-center justify-between",children:[e.jsxs("p",{className:"capitalize",children:[e.jsx("span",{className:"text-sm underline",children:"REASON :"})," ",a?.reason]}),e.jsx("p",{className:"text-sm",children:new Date(a?.createdAt)?.toString().substring(0,24)})]})]}))}),e.jsx("div",{className:"mt-4  text-center",children:e.jsx("button",{onClick:o,className:"w-full cursor-pointer border border-gray-300 hover:bg-gray-100 text-gray-700 font-medium py-2 rounded transition-colors",children:"Close"})})]})]})}),K=()=>{const{user:l}=t.useContext(S),[o,a]=t.useState(""),[n,c]=t.useState(""),[i,d]=t.useState(""),[x,p]=t.useState(0),[g,m]=t.useState(!1),[w,j]=t.useState({}),b=D(),{data:N}=u({queryKey:["status"],queryFn:L}),{data:h,refetch:y,isLoading:f}=u({queryKey:["leads",x],queryFn:()=>$(l?.id,x,o,n,i)}),v=async()=>{p(0),a(""),c(""),d(""),y()};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"overflow-hidden",children:e.jsxs("div",{className:"p-5",children:[e.jsxs(r.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.5,delay:0},children:[e.jsxs("div",{className:"grid grid-cols-3 gap-x-5 gap-y-3",children:[e.jsxs("div",{className:"flex flex-col space-y-1",children:[e.jsx("label",{htmlFor:"saleDate",children:"Sale Date"}),e.jsx("input",{type:"date",name:"saleDate",value:o,id:"saleDate",onChange:s=>a(s.target.value),className:"border border-gray-400 px-3 py-1 rounded-md outline-none"})]}),e.jsxs("div",{className:"flex flex-col space-y-1",children:[e.jsx("label",{htmlFor:"fromDate",children:"From Date"}),e.jsx("input",{type:"date",name:"fromDate",value:n,id:"fromDate",onChange:s=>c(s.target.value),className:"border border-gray-400 px-3 py-1 rounded-md outline-none"})]}),e.jsxs("div",{className:"flex flex-col space-y-1",children:[e.jsx("label",{htmlFor:"toDate",children:"To Date"}),e.jsx("input",{type:"date",name:"toDate",value:i,id:"toDate",onChange:s=>d(s.target.value),className:"border border-gray-400 px-3 py-1 rounded-md outline-none"})]})]}),e.jsxs("div",{className:"mb-10 mt-3 flex items-center gap-2 text-sm",children:[e.jsx("button",{onClick:()=>y(),className:"bg-green-500 text-white px-10 py-1 rounded-md cursor-pointer",children:"Search"}),e.jsx("button",{onClick:v,className:"bg-sky-500 text-white px-10 py-1 rounded-md cursor-pointer",children:"Reset Filters"})]})]}),e.jsxs("div",{className:"mb-5 text-gray-900 bg-white ",children:[e.jsx(r.p,{initial:{opacity:0,scale:1.2},animate:{opacity:1,scale:1},transition:{duration:.5},className:"text-3xl font-semibold uppercase origin-center w-fit",children:"Leads - All Leads"}),e.jsxs(r.p,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.25},className:"mt-1 text-sm font-normal text-gray-700 w-[50%]",children:["Browse list of leads closed by ",l?.name,"."]})]}),e.jsx(r.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.25},className:"mt-1 text-sm font-normal text-gray-700 w-[50%]",children:e.jsx("div",{className:"flex gap-x-1 mb-5",children:N?.map(s=>e.jsx("button",{onClick:()=>{p(s?.id),b.invalidateQueries({queryKey:["leads"]})},className:`${s?.name?.toLowerCase()==="success"?"bg-green-500":""} ${s?.name?.toLowerCase()==="cancelled"?"bg-red-500":""} ${s?.name?.toLowerCase()==="pending"?"bg-yellow-500":""} ${s?.name?.toLowerCase()==="rework/warmup"?"bg-sky-500":""} bg-gray-500 text-white text-xs font-semibold px-6 py-1 rounded-md capitalize cursor-pointer`,children:s?.name},s?.id))})}),e.jsx(r.div,{initial:{opacity:0,y:50},animate:{opacity:1,y:0},transition:{duration:.5},className:"relative overflow-x-auto shadow-md sm:rounded-lg",children:f?e.jsx(F,{}):h?.length>0?e.jsxs("table",{className:"w-full text-sm text-left rtl:text-right text-gray-500 ",children:[e.jsx("thead",{className:"text-center text-gray-700 uppercase bg-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-6 py-3",children:"Sr. No."}),e.jsx("th",{scope:"col",className:"px-6 py-3",children:"status"}),e.jsx("th",{scope:"col",className:"px-6 py-3",children:"Sale Date"}),e.jsx("th",{scope:"col",className:"px-6 py-3",children:"Name"}),e.jsx("th",{scope:"col",className:"px-6 py-3",children:"Process"}),e.jsx("th",{scope:"col",className:"px-6 py-3",children:"Plan"}),e.jsx("th",{scope:"col",className:"px-6 py-3",children:"action"})]})}),e.jsx("tbody",{children:h?.map((s,C)=>e.jsxs("tr",{className:" capitalize text-center border-b :border-gray-700 border-gray-200",children:[e.jsx("th",{scope:"row",className:"px-6 py-4 font-medium text-gray-900 whitespace-nowrap :text-white",children:C+1}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("p",{className:`${s?.status?.name?.toLowerCase()==="success"?"bg-green-500":""} ${s?.status?.name?.toLowerCase()==="pending"?"bg-yellow-500":""} ${s?.status?.name?.toLowerCase()==="cancelled"?"bg-red-500":""} ${s?.name?.toLowerCase()==="rework/warmup"?"bg-sky-500":""} px-3 py-1 text-xs rounded font-semibold text-white`,children:s?.status?.name})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:new Date(s?.saleDate).toDateString()}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[s?.title," ",s?.firstName," ",s?.middleName," ",s?.lastName]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s?.process?.name}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s?.plan?.name}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("button",{onClick:()=>{m(!0),j(s?.StatusChangeReason)},className:"px-3 py-1 text-xs rounded font-semibold bg-blue-500 cursor-pointer capitalize text-white",children:"view change in status"})})]},s?.id))})]}):e.jsx(k,{})})]})}),g&&e.jsx(z,{item:w,handleClose:()=>m(!1)})]})};export{K as default};
