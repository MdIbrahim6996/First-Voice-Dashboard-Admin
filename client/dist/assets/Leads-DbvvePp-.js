import{r as a,e as X,u as n,j as s,m as r,M as W,f as G}from"./index-_7Kt66s7.js";import{C as J,F as Z,a as _}from"./index-B5fjiqWK.js";import{u as ee}from"./useMutation-DU8bvPR1.js";import{g as se}from"./status-lndqRMdx.js";import{d as ae,g as te}from"./index-Cbi6rauC.js";import{g as le}from"./process-DEwozMBz.js";import{g as re}from"./user-CVQ9OdHo.js";import{D as oe}from"./DeleteModal-ChipbVUX.js";import{E as ne,L as ce}from"./LeadDetailModal-C1B1RLvu.js";import{L as de}from"./Loader-CKAgAapU.js";import{E as ie}from"./EmptyState-DZVI4ADE.js";import"./index-BinlR_4P.js";import"./plan-Csn77Bx3.js";const we=()=>{const[p,x]=a.useState(""),[u,m]=a.useState(0),[y,h]=a.useState(0),[f,N]=a.useState(0),[O,b]=a.useState(0),[g,j]=a.useState(""),[v,C]=a.useState(""),[w,U]=a.useState(""),[D,k]=a.useState(0),[S,E]=a.useState({}),[P,q]=a.useState(),L=a.useRef(null),A=a.useRef(null),V=a.useRef(null);a.useEffect(()=>{const e=L.current,t=A.current;if(!e||!t)return;const T=()=>t.scrollLeft=e.scrollLeft,B=()=>e.scrollLeft=t.scrollLeft;return e.addEventListener("scroll",T),t.addEventListener("scroll",B),()=>{e.removeEventListener("scroll",T),t.removeEventListener("scroll",B)}});const[c,l]=a.useState({edit:!1,delete:!1,view:!1}),F=X(),{data:K}=n({queryKey:["process"],queryFn:le}),{data:R}=n({queryKey:["user"],queryFn:re}),$=R?.filter(e=>e?.role==="user"),M=R?.filter(e=>e?.role==="closer"||e?.role==="verifier"),{data:I}=n({queryKey:["status"],queryFn:se}),{data:o,refetch:d,isLoading:Y}=n({queryKey:["leads",D],queryFn:()=>te(D,p,u,y,f,O,g,v,w)}),{mutate:H}=ee({mutationFn:e=>ae(e),onSuccess:()=>{F.invalidateQueries({queryKey:["leads"]})}}),i=o?.map(e=>({status:e?.status?.name?.toUpperCase(),saleDate:e?.saleDate?.substring(0,10),leadBy:e?.leadBy?.alias?.toUpperCase(),closer:e?.closer?.alias?.toUpperCase(),centre:e?.centre?.toUpperCase(),title:e?.title?.toUpperCase(),firstName:e?.firstName?.toUpperCase(),middleName:e?.middleName?.toUpperCase(),lastName:e?.lastName?.toUpperCase(),address:e?.address,city:e?.city?.toUpperCase(),county:e?.county?.toUpperCase(),post:e?.pincode,dateOfBirth:e?.dateOfBirth?.substring(0,10),password:e?.password,phone:e?.phone?.toString(),process:e?.process?.name?.toUpperCase(),plan:e?.plan?.name?.toUpperCase(),paymentMethod:e?.paymentMethod?.toUpperCase(),bankName:e?.bankName?.toUpperCase(),accountName:e?.accountName?.toUpperCase(),accountNumber:e?.accountNumber?.toUpperCase(),sort:e?.sort?.toUpperCase(),cardName:e?.cardName?.toUpperCase(),cardBankName:e?.cardBankName?.toUpperCase(),cardNumber:e?.cardNumber,cardCvv:e?.cardCvv,expiry:e?.expiry,comment:e?.comment}));console.log(o),console.log(i);const Q=[{label:"STATUS",key:"status"},{label:"SALE DATE",key:"saleDate"},{label:"LEAD USER",key:"leadBy"},{label:"CLOSER",key:"closer"},{label:"CENTRE",key:"centre"},{label:"TITLE",key:"title"},{label:"FIRST NAME",key:"firstName"},{label:"MIDDLE NAME",key:"middleName"},{label:"LAST NAME",key:"lastName"},{label:"ADDRESS",key:"address"},{label:"CITY",key:"city"},{label:"COUNTY",key:"county"},{label:"POST CODE",key:"post"},{label:"DATE OF BIRTH",key:"dateOfBirth"},{label:"PASSWORD",key:"password"},{label:"PHONE",key:"phone"},{label:"PROCESS",key:"process"},{label:"PLAN",key:"plan"},{label:"PAYMENT METHOD",key:"paymentMethod"},{label:"BANK NAME",key:"bankName"},{label:"ACCOUNT NAME",key:"accountName"},{label:"ACCOUNT NUMBER",key:"accountNumber"},{label:"SORT",key:"sort"},{label:"NAME ON CARD",key:"cardName"},{label:"CARD NUMBER",key:"cardNumber"},{label:"CARD EXPIRY",key:"expiry"},{label:"CARD CVV",key:"cardCvv"},{label:"COMMENT",key:"comment"}],z=()=>{x(""),N(0),h(0),b(0),k(0),m(0),j(""),C(""),U(""),d()};return s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"overflow-hidden",children:s.jsxs("div",{className:"p-5",children:[s.jsxs(r.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.5,delay:0},children:[s.jsxs("div",{className:"grid grid-cols-4 gap-x-5 gap-y-3",children:[s.jsxs("div",{className:"flex flex-col space-y-1",children:[s.jsx("label",{htmlFor:"phone",children:"Phone"}),s.jsx("input",{autoComplete:"off",type:"text",name:"phone",placeholder:"PHONE",value:p,onChange:e=>x(e?.target?.value),onKeyDown:e=>{e.key==="Enter"&&d()},id:"phone",className:"border border-gray-400 px-3 py-1 rounded-md outline-none"})]}),s.jsxs("div",{className:"flex flex-col space-y-1",children:[s.jsx("label",{htmlFor:"process",children:"Process"}),s.jsxs("select",{name:"process",id:"process",onChange:e=>m(e.target.value),value:u,className:"border outline-none border-gray-400 px-3 py-1 rounded-md",children:[s.jsx("option",{value:0,selected:!0,disabled:!0,children:"Select A Process"}),K?.map(e=>s.jsx("option",{value:e?.id,children:e?.name?.toUpperCase()},e?.id))]})]}),s.jsxs("div",{className:"flex flex-col space-y-1",children:[s.jsx("label",{htmlFor:"leadUser",children:"Lead User"}),s.jsxs("select",{name:"leadUser",id:"leadUser",value:y,onChange:e=>h(e?.target?.value),className:"border outline-none border-gray-400 px-3 py-1 rounded-md",children:[s.jsx("option",{value:0,selected:!0,disabled:!0,children:"Select Lead User"}),$?.map(e=>s.jsx("option",{value:e?.id,className:"uppercase",children:e?.alias},e?.id))]})]}),s.jsxs("div",{className:"flex flex-col space-y-1",children:[s.jsx("label",{htmlFor:"closerUser",children:"Closer User"}),s.jsxs("select",{name:"closerUser",value:f,onChange:e=>N(e?.target?.value),id:"closerUser",className:"border outline-none border-gray-400 px-3 py-1 rounded-md",children:[s.jsx("option",{value:0,selected:!0,disabled:!0,children:"Select Closer User"}),M?.map(e=>s.jsx("option",{value:e?.id,className:"uppercase",children:e?.alias},e?.id))]})]}),s.jsxs("div",{className:"flex flex-col space-y-1",children:[s.jsx("label",{htmlFor:"verifierUser",children:"Verifier User"}),s.jsxs("select",{name:"verifierUser",onChange:e=>b(e?.target?.value),id:"verifierUser",className:"border outline-none border-gray-400 px-3 py-1 rounded-md",children:[s.jsx("option",{value:0,selected:!0,disabled:!0,children:"Select Verifier User"}),M?.map(e=>s.jsx("option",{value:e?.id,className:"uppercase",children:e?.alias},e?.id))]})]}),s.jsxs("div",{className:"flex flex-col space-y-1",children:[s.jsx("label",{htmlFor:"saleDate",children:"Sale Date"}),s.jsx("input",{type:"date",name:"saleDate",value:g,id:"saleDate",onChange:e=>j(e.target.value),className:"border border-gray-400 px-3 py-1 rounded-md outline-none"})]}),s.jsxs("div",{className:"flex flex-col space-y-1",children:[s.jsx("label",{htmlFor:"fromDate",children:"From Date"}),s.jsx("input",{type:"date",name:"fromDate",value:v,id:"fromDate",onChange:e=>C(e.target.value),className:"border border-gray-400 px-3 py-1 rounded-md outline-none"})]}),s.jsxs("div",{className:"flex flex-col space-y-1",children:[s.jsx("label",{htmlFor:"toDate",children:"To Date"}),s.jsx("input",{type:"date",name:"toDate",value:w,id:"toDate",onChange:e=>U(e.target.value),className:"border border-gray-400 px-3 py-1 rounded-md outline-none"})]})]}),s.jsxs("div",{className:"mb-10 mt-3 flex items-center gap-2 text-sm",children:[s.jsx("button",{onClick:()=>d(),className:"bg-green-500 text-white px-10 py-1 rounded-md cursor-pointer",children:"Search"}),s.jsx("button",{onClick:z,className:"bg-sky-500 text-white px-10 py-1 rounded-md cursor-pointer",children:"Reset Filters"})]})]}),s.jsxs("div",{className:"mb-5  text-gray-900 bg-white ",children:[s.jsx(r.p,{initial:{opacity:0,scale:1.2},animate:{opacity:1,scale:1},transition:{duration:.5},className:"text-3xl font-semibold uppercase origin-center w-fit",children:"Leads - All Leads"}),s.jsx(r.p,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.25},className:"mt-1 text-sm font-normal text-gray-700 w-[50%]",children:"Browse a list of Flowbite products designed to help you work and play, stay organized, get answers, keep in touch, grow your business, and more."})]}),s.jsx(r.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.25},className:"mt-1 text-sm font-normal text-gray-700 w-full",children:s.jsxs("div",{className:"flex mb-5 items-center justify-between",children:[s.jsx("div",{className:"flex gap-x-1",children:I?.map(e=>s.jsx("button",{onClick:()=>{k(e?.id),F.invalidateQueries({queryKey:["leads"]})},className:`${e?.name.toLowerCase()==="success"?"bg-green-500":""} ${e?.name.toLowerCase()==="cancelled"?"bg-red-500":""} ${e?.name.toLowerCase()==="pending"?"bg-yellow-500":""} ${e?.name.toLowerCase()==="rework/warmup"?"bg-sky-500":""} bg-gray-500 text-white text-xs font-semibold px-6 py-1 rounded-md capitalize cursor-pointer`,children:e?.name},e?.id))}),s.jsx(J,{headers:Q,data:i||[],filename:"Leads.csv",children:s.jsxs("button",{className:"py-1.5 px-7 bg-green-700 text-white rounded-md text-sm flex gap-1 items-center cursor-pointer",children:[s.jsx(Z,{className:"text-lg"})," Export as CSV"]})})]})}),s.jsxs(r.div,{initial:{opacity:0,y:50},animate:{opacity:1,y:0},transition:{duration:.5},className:"relative overflow-x-auto shadow-md sm:rounded-lg w-full",children:[s.jsx("div",{ref:L,style:{overflowX:"auto",overflowY:"hidden",height:"20px"},children:s.jsx("div",{style:{width:"2000px",height:"1px"}})}),s.jsx("div",{ref:A,style:{overflowX:"auto",overflowY:"hidden",width:"100%"},children:Y?s.jsx(de,{}):o?.length>0?s.jsxs("table",{ref:V,className:"text-sm text-left rtl:text-right text-gray-500",children:[s.jsx("thead",{className:"text-center text-gray-700 uppercase bg-gray-200",children:s.jsxs("tr",{children:[s.jsx("th",{scope:"col",className:"px-6 py-3",children:"Sr. No."}),s.jsx("th",{scope:"col",className:"px-6 py-3",children:"Actions"}),s.jsx("th",{scope:"col",className:"px-6 py-3",children:"status"}),s.jsx("th",{scope:"col",className:"px-6 py-3",children:"Sale Date"}),s.jsx("th",{scope:"col",className:"px-6 py-3",children:"Lead By"}),s.jsx("th",{scope:"col",className:"px-6 py-3",children:"Closed By"}),s.jsx("th",{scope:"col",className:"px-6 py-3",children:"Verified By"}),s.jsx("th",{scope:"col",className:"px-6 py-3",children:"Name"}),s.jsx("th",{scope:"col",className:"px-6 py-3",children:"Phone"}),s.jsx("th",{scope:"col",className:"px-6 py-3",children:"Process"}),s.jsx("th",{scope:"col",className:"px-6 py-3",children:"Plan"})]})}),s.jsx("tbody",{children:o?.map((e,t)=>s.jsxs("tr",{className:" capitalize text-center border-b :border-gray-700 border-gray-200",children:[s.jsx("th",{scope:"row",className:"px-6 py-4 font-medium text-gray-900 whitespace-nowrap :text-white",children:t+1}),s.jsxs("td",{className:"px-6 py-4 flex flex-col gap-1 items-center",children:[s.jsx("button",{onClick:()=>{l({edit:!0,delete:!1,view:!1}),E(e)},className:"font-medium text-white bg-green-500 rounded-md w-fit px-2 py-1 text-sm flex items-center gap-1 cursor-pointer",children:s.jsx(W,{})}),s.jsx("button",{onClick:()=>{E(e),l({edit:!1,delete:!1,view:!0})},className:"font-medium text-white bg-blue-500 rounded-md w-fit px-2 py-1 text-sm flex items-center gap-1 cursor-pointer",children:s.jsx(_,{})}),s.jsx("button",{onClick:()=>{q(e?.id),l({edit:!1,delete:!0,view:!1})},className:"font-medium text-white bg-red-500 rounded-md w-fit px-2 py-1 text-sm flex items-center gap-1 cursor-pointer",children:s.jsx(G,{})})]}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsx("p",{className:`${e?.status?.name?.toLowerCase()==="success"?"bg-green-500":""} ${e?.status?.name?.toLowerCase()==="pending"?"bg-yellow-500":""} ${e?.status?.name?.toLowerCase()==="cancelled"?"bg-red-500":""} ${e?.status?.name?.toLowerCase()==="rework/warmup"?"bg-sky-500":""} px-3 py-1 text-xs rounded font-semibold text-white`,children:e?.status?.name})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap uppercase",children:new Date(e?.saleDate).toDateString()}),s.jsx("td",{className:"px-6 py-4 uppercase",children:e?.leadBy?.alias}),s.jsx("td",{className:"px-6 py-4 uppercase",children:e?.closer?.alias}),s.jsx("td",{className:"px-6 py-4 uppercase",children:e?.verifier?.alias}),s.jsxs("td",{className:"px-6 py-4 whitespace-nowrap uppercase",children:[e?.title," ",e?.firstName," ",e?.middleName," ",e?.lastName]}),s.jsx("td",{className:"px-6 py-4",children:e?.phone}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap uppercase",children:e?.process?.name}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap uppercase",children:e?.plan?.name})]},e?.id))})]}):s.jsx(ie,{})})]})]})}),c.delete&&s.jsx(oe,{handleClose:()=>l({edit:!1,view:!1,delete:!1}),handleDelete:()=>H(P)}),c.edit&&s.jsx(ne,{handleClose:()=>l({edit:!1,view:!1,delete:!1}),item:S}),c.view&&s.jsx(ce,{handleClose:()=>l({edit:!1,view:!1,delete:!1}),details:S})]})};export{we as default};
